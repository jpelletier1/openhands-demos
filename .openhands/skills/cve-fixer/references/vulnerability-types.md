# Vulnerability Types Reference

## Overview

Trivy detects various types of security issues in applications. This document provides detailed information about each vulnerability category.

## Vulnerability Categories

### 1. Library Vulnerabilities

Trivy scans application dependencies for known vulnerabilities.

#### Supported Ecosystems

| Ecosystem | Lock File | Package Manager |
|-----------|-----------|-----------------|
| npm | package-lock.json | Node.js |
| Python | requirements.txt, Pipfile.lock | pip, pipenv |
| Go | go.sum | Go modules |
| Java | pom.xml, build.gradle | Maven, Gradle |
| Ruby | Gemfile.lock | Bundler |
| Rust | Cargo.lock | Cargo |
| .NET | packages.lock.json | NuGet |
| PHP | composer.lock | Composer |

#### Common Fixes

```bash
# npm
npm update
npm audit fix

# pip
pip install -U package-name
pip-compile --upgrade

# Go
go get -u package
go mod tidy

# Maven
mvn dependency:update
```

### 2. Configuration Issues

Trivy scans configuration files for security misconfigurations.

#### Docker

- Exposed sensitive ports
- Running as root
- Missing health checks
- Insecure base images
- Privileged mode enabled
- Sensitive data in environment variables

**Example Dockerfile issue:**
```dockerfile
# BAD: Running as root
FROM ubuntu:20.04
USER root

# GOOD: Use non-root user
FROM ubuntu:20.04
RUN useradd -m appuser
USER appuser
```

#### Kubernetes

- Running as root
- Privileged containers
- Missing resource limits
- Insecure security contexts
- Network policies missing

**Example Pod security:**
```yaml
# BAD
securityContext:
  runAsRoot: true

# GOOD
securityContext:
  runAsNonRoot: true
  runAsUser: 10000
  fsGroup: 2000
```

#### Terraform

- S3 buckets public
- Weak encryption
- IAM overly permissive
- Security group too open

### 3. Secret Detection

Trivy can detect exposed secrets in code.

#### Detectable Secrets

- API keys
- Passwords
- Tokens
- Private keys
- Database credentials
- AWS credentials

#### Best Practices

- Use environment variables
- Use secret management tools (Vault, AWS Secrets Manager)
- Never commit secrets to version control
- Use .gitignore for sensitive files

### 4. Infrastructure as Code

#### Terraform

| Issue | Severity | Fix |
|-------|----------|-----|
| S3 bucket public | CRITICAL | Block public access |
| Unencrypted storage | HIGH | Enable encryption |
| Weak IAM policy | HIGH | Restrict permissions |
| Open security group | HIGH | Limit access |

#### Kubernetes

| Issue | Severity | Fix |
|-------|----------|-----|
| Privileged container | CRITICAL | Set privileged: false |
| Running as root | HIGH | Use runAsNonRoot |
| No resource limits | MEDIUM | Set resources limits |
| hostPath volume | HIGH | Use PVC |

## Severity Levels

### Critical (CVSS 9.0-10.0)

- Remote code execution
- Data breach
- Complete system compromise

**Action:** Fix immediately

### High (CVSS 7.0-8.9)

- Privilege escalation
- Denial of service
- Data tampering

**Action:** Fix within 30 days

### Medium (CVSS 4.0-6.9)

- Information disclosure
- Limited privilege escalation

**Action:** Fix within 90 days

### Low (CVSS 0.1-3.9)

- Minor security issues

**Action:** Fix during next update

## CVE Details

### Reading CVE Information

Each CVE includes:
- CVE ID (e.g., CVE-2024-1234)
- Description
- Severity
- Affected versions
- Fixed versions
- References

### Example

```
CVE-2024-1234
Severity: HIGH
Package: django
Affected: < 4.2.8
Fixed: 4.2.8
Description: SQL injection in Django ORM
```

## Prioritization

### Priority Order

1. Critical vulnerabilities in exposed services
2. Remote code execution vulnerabilities
3. Authentication/authorization bypass
4. Data exposure vulnerabilities
5. Denial of service
6. Configuration issues

### Risk Factors

- Is the vulnerable component exposed?
- Is there a fix available?
- Is the fix easy to apply?
- What is the impact of exploitation?

## Remediation Strategies

### Immediate Actions

1. Update to latest secure version
2. Apply security patches
3. Remove vulnerable components
4. Implement compensating controls

### Long-term Actions

1. Regular security scanning
2. Dependency management
3. Security training
4. Automated scanning in CI/CD
